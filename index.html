<!--
  Copyright 2018 The Distill Template Authors

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<!doctype html>

<style>

</style>
<head>
    <title>SR3: Iterative Image Enhancement</title>
    <script src="template.v2.js"></script>
    <meta property="og:title" content="SR3: Image Super-Resolution via Iterative Refinement">
    <meta property="og:type" content="website">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <meta charset="utf8">
</head>

<body>
  <d-front-matter>
    <script id='distill-front-matter' type="text/json">{
    "title": "Image Super-Resolution via Iterative Refinement",
    "description": "Using Diffusion Models for Super-Resolution and Cascaded Generation.",
    "published": "April 15, 2021",
    "authors": [
      {
        "author":"Chitwan Saharia",
        "authorURL":"https://chitwansaharia.github.io/",
        "affiliations": [{"name": "Google Research, Brain Team", "url": "https://g.co/brain"}]
      },
      {
        "author":"Jonathan Ho",
        "authorURL":"https://jonathanho.me",
        "affiliations": [{"name": "Google Research, Brain Team", "url": "https://g.co/brain"}]
      },
      {
        "author":"William Chan",
        "authorURL":"https://williamchan.ca",
        "affiliations": [{"name": "Google Research, Brain Team", "url": "https://g.co/brain"}]
      },
      {
        "author":"Tim Salimans",
        "authorURL":"https://research.google/people/106222/",
        "affiliations": [{"name": "Google Research, Brain Team", "url": "https://g.co/brain"}]
      },
      {
        "author":"David Fleet",
        "authorURL":"http://www.cs.toronto.edu/~fleet/",
        "affiliations": [{"name": "Google Research, Brain Team", "url": "https://g.co/brain"}]
      },
      {
        "author":"Mohammad Norouzi",
        "authorURL":"http://norouzi.github.io",
        "affiliations": [{"name": "Google Research, Brain Team", "url": "https://g.co/brain"}]
      }
    ],
    "doi": "https://arxiv.org/pdf/2104.07636",
    "katex": {
      "delimiters": [
        {"left": "$$", "right": "$$", "display": false}
      ]
    }
  }</script>
  </d-front-matter>
  <d-title>
    <p>
      Diffusion probabilistic models for image super-resolution and cascaded image generation.
    </p>
  </d-title>
  <d-byline></d-byline>
  <d-article>
    <video controls="" autoplay="" loop="" width="1080" height="560" style="object-fit: contain;grid-column: page;">
     <source src="images/super_res_movie.m4v" type="video/mp4">
     </video>
    <h2>Abstract</h2>
    <p>
      We present SR3, an approach to image Super-Resolution via
      Repeated Refinement. SR3 adapts denoising diffusion
      probabilistic models to conditional image generation and
      performs super-resolution through a stochastic denoising
      process. Inference starts with pure Gaussian noise and
      iteratively refines the noisy output using a U-Net model trained
      on denoising at various noise levels. SR3 exhibits strong
      performance on super-resolution tasks at different magnification
      factors, on faces and natural images. We conduct human
      evaluation on a standard 8X face super-resolution task on
      CelebA-HQ, comparing with SOTA GAN methods. SR3 achieves a fool
      rate close to 50%, suggesting photo-realistic outputs, while
      GANs do not exceed a fool rate of 34%. We further show the
      effectiveness of SR3 in cascaded image generation, where
      generative models are chained with super-resolution models,
      yielding a competitive FID score of 11.3 on ImageNet.
    </p>
    <h2>Super-Resolution Results</h2>
    <p>
      We demonstrate the performance of SR3 on the tasks of face and natural image super-resolution. We perform face super-resolution at 16x16 -> 128x128, 64x64 -> 512x512. We also train face super-resolution model for 64x64 -> 256x256 and 256x256 -> 1024x1024 effectively allowing us to do 16x super-resolution through cascading. We also explore 64x64 -> 256x256 super-resolution on natural images.
    </p>
    <figure  style="grid-column: text">
        <img src="images/super_res_examples.png" style="width: 100%; margin-top: 1rem;"/>
          <figcaption> Super Resolution results: (Above) 64x64 -> 512x512 face super-resolution, (Below) 64x64 -> 256x256 natural image super-resolution.  </figcaption>
    </figure>


    <figure  style="grid-column: text">
        <img src="images/human_eval.png" style="width: 100%; margin-top: 1rem;"/>
          <figcaption> We conduct 2-Alternatative Forced Choice Experiment human evaluation experiment. Subjects are asked to choose between reference high resolution image, and the model output. We measure the performance of the model through fool rates (% of time, raters choose model output over reference images.) (Above) We achieve close to 50% fool rate on the task of 16x16 -> 128x128 faces outperforming state of the art face super-resolution methods. (Below) We also achieve 40% fool rate on the much difficult task of 64x64 -> 256x256 natural images outperforming regression baseline by a large margin. </figcaption>
    </figure>
        <!-- <figure style="grid-column: kicker "> -->
        <!--     <img src="water_lilies.jpg" style="width: 100%; max-width: 150px; margin-left: auto;  margin-right: auto; display: block;"/> -->
        <!--       <figcaption> First Google image search result for <a href="https://www.google.ca/search?tbm=isch&q=a+woman+is+staring+at+monet%27s+water+lilies&oq=a+woman+staring+at+Monet\%27s+Water+Lilies">''A woman is staring at Monet's Water Lilies''</a>. </figcaption> -->
        <!-- </figure> -->
    <p>
      <h2>Unconditional Generation Results</h2>
      <p>
        We generate unconditional 1024x1024 unconditional face images using a cascade of an unconditional diffusion model at 64x64 resolution followed by two 4x super-resolution models. We also generate 256x256 class conditional natural images by using a cascade of a class conditional diffusion model at 64x64 resolution followed by a 4x super-resolution model. Cascaded generation allows training different models in parallel and inference is also efficient as lower resolution models can use more iterations, while higher resolution models use fewer iterations.
      </p>

      <figure  style="grid-column: text">
          <img src="images/cascade_fig.svg" style="width: 100%; margin-top: 1rem;display: block; margin-left: auto; margin-right: auto;"/>
          <figcaption style="display:flex; justify-content: center"> Cascaded generation of unconditional 1024x1024 faces.  </figcaption>
      </figure>

      <figure  style="grid-column: text">
          <img src="images/unconditional_faces.png" style="width: 100%; margin-top: 1rem;display: block; margin-left: auto; margin-right: auto;"/>
          <figcaption style="display:flex; justify-content: center"> Selected example generations of unconditional 1024x1024 faces.  </figcaption>
      </figure>

      <figure  style="grid-column: text">
          <img src="images/class_cond_images.png" style="width: 100%; margin-top: 1rem;display: block; margin-left: auto; margin-right: auto;"/>
          <figcaption style="display:flex; justify-content: center"> Selected example generations of class conditional 256x256 natural images. Each row contains examples from a particular class.  </figcaption>
      </figure>

      <h2>Paper and Citation</h2>
      <p>
      Details about our method, and more samples can be found in our <a href="https://arxiv.org/pdf/2104.07636">paper</a>. 
      <code>@article{saharia2021image,<br>&nbsp; title={Image super-resolution via iterative refinement},<br>&nbsp; author={Saharia, Chitwan and Ho, Jonathan and Chan, William and Salimans, Tim and Fleet, David J and Norouzi, Mohammad}, <br>&nbsp; journal={arXiv preprint arXiv:2104.07636}, <br>&nbsp; year={2021}<br>}<br></code>

      </p>


  </d-article>




</body>
